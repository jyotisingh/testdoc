var parse=require("./parse"),_=require("lodash"),api=[require("./api/attributes"),require("./api/traversing"),require("./api/manipulation"),require("./api/css"),require("./api/forms")],quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Cheerio=module.exports=function(a,b,c,d){return this instanceof Cheerio?(this.options=_.defaults(d||{},this.options),a?(c&&("string"==typeof c&&(c=parse(c,this.options)),this._root=Cheerio.call(this,c)),a.cheerio?a:(isNode(a)&&(a=[a]),Array.isArray(a)?(_.forEach(a,function(a,b){this[b]=a},this),this.length=a.length,this):"string"==typeof a&&isHtml(a)?Cheerio.call(this,parse(a,this.options).children):(b?"string"==typeof b?isHtml(b)?(b=parse(b,this.options),b=Cheerio.call(this,b)):(a=[b,a].join(" "),b=this._root):b.cheerio||(b=Cheerio.call(this,b)):b=this._root,b?b.find(a):this))):this):new Cheerio(a,b,c,d)};_.extend(Cheerio,require("./static")),Cheerio.prototype.cheerio="[cheerio object]",Cheerio.prototype.options={withDomLvl1:!0,normalizeWhitespace:!1,xmlMode:!1,decodeEntities:!0},Cheerio.prototype.length=0,Cheerio.prototype.splice=Array.prototype.splice;var isHtml=function(a){if("<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3)return!0;var b=quickExpr.exec(a);return!(!b||!b[1])};Cheerio.prototype._make=function(a,b){var c=new this.constructor(a,b,this._root,this.options);return c.prevObject=this,c},Cheerio.prototype.toArray=function(){return this.get()},api.forEach(function(a){_.extend(Cheerio.prototype,a)});var isNode=function(a){return a.name||"text"===a.type||"comment"===a.type};